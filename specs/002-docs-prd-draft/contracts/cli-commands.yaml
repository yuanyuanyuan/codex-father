name: PRD CLI Commands Contract
description: Command-line interface contracts for PRD Draft Documentation System
version: 1.0.0

commands:
  # Main PRD Command Group
  prd:
    description: "PRD Draft Documentation System CLI"
    usage: "prd <subcommand> [options]"
    global_options:
      - name: "--config"
        alias: "-c"
        type: "string"
        description: "Path to configuration file"
        default: "~/.codex-father/config.yaml"
      - name: "--json"
        type: "boolean"
        description: "Output in JSON format"
        default: false
      - name: "--verbose"
        alias: "-v"
        type: "boolean"
        description: "Enable verbose logging"
        default: false
      - name: "--help"
        alias: "-h"
        type: "boolean"
        description: "Show help information"

    subcommands:
      # Draft Management
      create:
        description: "Create a new PRD draft"
        usage: "prd create [options]"
        options:
          - name: "--title"
            alias: "-t"
            type: "string"
            required: true
            description: "Draft title"
            validation:
              min_length: 1
              max_length: 200
          - name: "--template"
            type: "string"
            description: "Template ID to use"
            default: "default"
          - name: "--description"
            alias: "-d"
            type: "string"
            description: "Brief description"
            validation:
              max_length: 500
          - name: "--output"
            alias: "-o"
            type: "string"
            description: "Output file path"
          - name: "--interactive"
            alias: "-i"
            type: "boolean"
            description: "Interactive creation mode"
            default: false
        examples:
          - command: "prd create --title 'User Authentication System' --template technical"
            description: "Create PRD with technical template"
          - command: "prd create -t 'Mobile App' -i"
            description: "Create PRD interactively"
        returns:
          success:
            exit_code: 0
            output:
              json:
                type: "object"
                properties:
                  id: "string"
                  title: "string"
                  status: "string"
                  created_at: "string"
              human:
                format: "‚úÖ PRD draft '{title}' created successfully (ID: {id})"
          error:
            exit_code: 1
            output:
              json:
                type: "object"
                properties:
                  error: "string"
                  code: "string"
              human:
                format: "‚ùå Error: {error}"

      list:
        description: "List PRD drafts"
        usage: "prd list [options]"
        options:
          - name: "--status"
            alias: "-s"
            type: "string"
            description: "Filter by status"
            enum: ["draft", "in_review", "changes_requested", "approved", "rejected", "confirmed"]
          - name: "--author"
            alias: "-a"
            type: "string"
            description: "Filter by author"
          - name: "--template"
            type: "string"
            description: "Filter by template"
          - name: "--search"
            type: "string"
            description: "Search in title and content"
          - name: "--limit"
            alias: "-l"
            type: "integer"
            description: "Limit number of results"
            default: 20
            validation:
              min: 1
              max: 100
          - name: "--sort"
            type: "string"
            description: "Sort order"
            enum: ["created", "updated", "title", "status"]
            default: "updated"
          - name: "--reverse"
            alias: "-r"
            type: "boolean"
            description: "Reverse sort order"
            default: false
        examples:
          - command: "prd list --status draft"
            description: "List drafts in draft status"
          - command: "prd list --author john --sort created"
            description: "List John's drafts sorted by creation date"
        returns:
          success:
            exit_code: 0
            output:
              json:
                type: "object"
                properties:
                  drafts:
                    type: "array"
                    items:
                      type: "object"
                      properties:
                        id: "string"
                        title: "string"
                        status: "string"
                        author: "string"
                        created_at: "string"
                        updated_at: "string"
                  total: "integer"
              human:
                format: |
                  üìã PRD Drafts ({total} total)

                  ID       Title                    Status      Author    Updated
                  -------- ------------------------ ----------- --------- ----------
                  {id}     {title}                  {status}    {author}  {updated}

      show:
        description: "Show PRD draft details"
        usage: "prd show <draft-id> [options]"
        arguments:
          - name: "draft-id"
            type: "string"
            required: true
            description: "Draft ID or title"
        options:
          - name: "--version"
            alias: "-v"
            type: "integer"
            description: "Show specific version"
          - name: "--content"
            alias: "-c"
            type: "boolean"
            description: "Include full content"
            default: true
          - name: "--format"
            alias: "-f"
            type: "string"
            description: "Output format"
            enum: ["markdown", "html", "text"]
            default: "markdown"
          - name: "--sections"
            type: "string"
            description: "Comma-separated section IDs to show"
          - name: "--no-metadata"
            type: "boolean"
            description: "Hide metadata"
            default: false
        examples:
          - command: "prd show abc-123 --format html"
            description: "Show draft in HTML format"
          - command: "prd show 'User Auth' --version 2"
            description: "Show specific version by title"

      edit:
        description: "Edit PRD draft"
        usage: "prd edit <draft-id> [options]"
        arguments:
          - name: "draft-id"
            type: "string"
            required: true
            description: "Draft ID or title"
        options:
          - name: "--editor"
            alias: "-e"
            type: "string"
            description: "Editor command"
            default: "$EDITOR"
          - name: "--section"
            alias: "-s"
            type: "string"
            description: "Edit specific section"
          - name: "--message"
            alias: "-m"
            type: "string"
            description: "Commit message"
          - name: "--no-commit"
            type: "boolean"
            description: "Don't auto-commit changes"
            default: false
          - name: "--backup"
            type: "boolean"
            description: "Create backup before editing"
            default: true
        examples:
          - command: "prd edit abc-123 --section overview"
            description: "Edit overview section"
          - command: "prd edit 'User Auth' -m 'Updated requirements'"
            description: "Edit with commit message"

      delete:
        description: "Delete PRD draft"
        usage: "prd delete <draft-id> [options]"
        arguments:
          - name: "draft-id"
            type: "string"
            required: true
            description: "Draft ID or title"
        options:
          - name: "--force"
            alias: "-f"
            type: "boolean"
            description: "Permanent deletion (skip archive)"
            default: false
          - name: "--confirm"
            type: "boolean"
            description: "Skip confirmation prompt"
            default: false
        examples:
          - command: "prd delete abc-123"
            description: "Archive draft (soft delete)"
          - command: "prd delete abc-123 --force --confirm"
            description: "Permanently delete without prompt"

      # Review Management
      review:
        description: "Review management commands"
        usage: "prd review <subcommand> [options]"
        subcommands:
          submit:
            description: "Submit draft for review"
            usage: "prd review submit <draft-id> [options]"
            arguments:
              - name: "draft-id"
                type: "string"
                required: true
                description: "Draft ID or title"
            options:
              - name: "--reviewers"
                alias: "-r"
                type: "string"
                description: "Comma-separated reviewer usernames"
                required: true
              - name: "--due-date"
                alias: "-d"
                type: "string"
                description: "Review due date (ISO 8601)"
              - name: "--priority"
                alias: "-p"
                type: "string"
                description: "Review priority"
                enum: ["low", "medium", "high"]
                default: "medium"
              - name: "--message"
                alias: "-m"
                type: "string"
                description: "Review request message"
            examples:
              - command: "prd review submit abc-123 -r 'john,jane' -d '2025-10-01'"
                description: "Submit for review with deadline"

          status:
            description: "Check review status"
            usage: "prd review status <draft-id>"
            arguments:
              - name: "draft-id"
                type: "string"
                required: true
                description: "Draft ID or title"

          respond:
            description: "Respond to review request"
            usage: "prd review respond <draft-id> [options]"
            arguments:
              - name: "draft-id"
                type: "string"
                required: true
                description: "Draft ID or title"
            options:
              - name: "--decision"
                type: "string"
                required: true
                enum: ["approved", "rejected", "changes_requested"]
                description: "Review decision"
              - name: "--comments"
                alias: "-c"
                type: "string"
                description: "Review comments file path"
              - name: "--inline"
                type: "string"
                description: "Inline comment text"

      # Version Management
      version:
        description: "Version management commands"
        usage: "prd version <subcommand> [options]"
        subcommands:
          list:
            description: "List draft versions"
            usage: "prd version list <draft-id>"
            arguments:
              - name: "draft-id"
                type: "string"
                required: true
                description: "Draft ID or title"

          show:
            description: "Show specific version"
            usage: "prd version show <draft-id> <version-number>"
            arguments:
              - name: "draft-id"
                type: "string"
                required: true
                description: "Draft ID or title"
              - name: "version-number"
                type: "integer"
                required: true
                description: "Version number"

          restore:
            description: "Restore to specific version"
            usage: "prd version restore <draft-id> <version-number> [options]"
            arguments:
              - name: "draft-id"
                type: "string"
                required: true
                description: "Draft ID or title"
              - name: "version-number"
                type: "integer"
                required: true
                description: "Version number"
            options:
              - name: "--message"
                alias: "-m"
                type: "string"
                required: true
                description: "Restoration reason"

          diff:
            description: "Compare versions"
            usage: "prd version diff <draft-id> [options]"
            arguments:
              - name: "draft-id"
                type: "string"
                required: true
                description: "Draft ID or title"
            options:
              - name: "--from"
                type: "integer"
                description: "From version (default: current-1)"
              - name: "--to"
                type: "integer"
                description: "To version (default: current)"
              - name: "--format"
                type: "string"
                enum: ["unified", "side-by-side", "json"]
                default: "unified"

      # Template Management
      template:
        description: "Template management commands"
        usage: "prd template <subcommand> [options]"
        subcommands:
          list:
            description: "List available templates"
            usage: "prd template list"

          show:
            description: "Show template details"
            usage: "prd template show <template-id>"
            arguments:
              - name: "template-id"
                type: "string"
                required: true
                description: "Template ID"

          create:
            description: "Create new template"
            usage: "prd template create [options]"
            options:
              - name: "--name"
                alias: "-n"
                type: "string"
                required: true
                description: "Template name"
              - name: "--description"
                alias: "-d"
                type: "string"
                required: true
                description: "Template description"
              - name: "--from"
                type: "string"
                description: "Base template ID"
              - name: "--file"
                alias: "-f"
                type: "string"
                description: "Template definition file"

          validate:
            description: "Validate template structure"
            usage: "prd template validate <template-file>"
            arguments:
              - name: "template-file"
                type: "string"
                required: true
                description: "Template definition file"

      # Utility Commands
      config:
        description: "Configuration management"
        usage: "prd config <subcommand> [options]"
        subcommands:
          show:
            description: "Show current configuration"
            usage: "prd config show [options]"
            options:
              - name: "--key"
                alias: "-k"
                type: "string"
                description: "Show specific configuration key"

          set:
            description: "Set configuration value"
            usage: "prd config set <key> <value>"
            arguments:
              - name: "key"
                type: "string"
                required: true
                description: "Configuration key"
              - name: "value"
                type: "string"
                required: true
                description: "Configuration value"

          init:
            description: "Initialize configuration"
            usage: "prd config init [options]"
            options:
              - name: "--force"
                alias: "-f"
                type: "boolean"
                description: "Overwrite existing configuration"
                default: false

      export:
        description: "Export PRD draft"
        usage: "prd export <draft-id> [options]"
        arguments:
          - name: "draft-id"
            type: "string"
            required: true
            description: "Draft ID or title"
        options:
          - name: "--format"
            alias: "-f"
            type: "string"
            required: true
            enum: ["markdown", "html", "pdf", "docx"]
            description: "Export format"
          - name: "--output"
            alias: "-o"
            type: "string"
            description: "Output file path"
          - name: "--template"
            type: "string"
            description: "Export template"
          - name: "--include-metadata"
            type: "boolean"
            description: "Include metadata in export"
            default: true
          - name: "--include-history"
            type: "boolean"
            description: "Include version history"
            default: false

      import:
        description: "Import PRD draft from file"
        usage: "prd import <file> [options]"
        arguments:
          - name: "file"
            type: "string"
            required: true
            description: "Source file path"
        options:
          - name: "--format"
            alias: "-f"
            type: "string"
            enum: ["markdown", "html", "docx", "auto"]
            default: "auto"
            description: "Source format"
          - name: "--template"
            alias: "-t"
            type: "string"
            description: "Target template ID"
          - name: "--title"
            type: "string"
            description: "Override document title"
          - name: "--dry-run"
            type: "boolean"
            description: "Preview import without creating"
            default: false

      search:
        description: "Search across PRD drafts"
        usage: "prd search <query> [options]"
        arguments:
          - name: "query"
            type: "string"
            required: true
            description: "Search query"
        options:
          - name: "--in"
            type: "string"
            enum: ["title", "content", "all"]
            default: "all"
            description: "Search scope"
          - name: "--status"
            type: "string"
            description: "Filter by status"
          - name: "--author"
            type: "string"
            description: "Filter by author"
          - name: "--limit"
            alias: "-l"
            type: "integer"
            default: 10
            description: "Limit results"

# CLI Error Codes
error_codes:
  0: "Success"
  1: "General error"
  2: "Invalid arguments"
  3: "File not found"
  4: "Permission denied"
  5: "Network error"
  6: "Authentication failed"
  7: "Validation error"
  8: "Conflict error"
  9: "Resource not found"
  10: "Configuration error"

# Global Exit Behavior
exit_behavior:
  interrupt_handling: true
  cleanup_on_exit: true
  progress_indicators: true
  colored_output: true
  verbose_errors: true

# Configuration Schema
configuration:
  file_path: "~/.codex-father/prd-config.yaml"
  schema:
    api:
      base_url: "string"
      timeout: "integer"
      retries: "integer"
    auth:
      method: "string"
      token: "string"
    editor:
      command: "string"
      args: "array"
    templates:
      default: "string"
      search_paths: "array"
    output:
      format: "string"
      colors: "boolean"
      pager: "boolean"
    behavior:
      auto_save: "boolean"
      backup: "boolean"
      confirm_delete: "boolean"